using System;
using System.Globalization;
using Xunit;
using AtlasERP.Desktop.Converters;

namespace AtlasERP.Desktop.Converters;

public class StringNotEmptyConverterTest
{
    [Fact]
    public void Convert_ShouldReturnTrue_WhenValueIsNonEmptyString()
    {
        // Arrange
        var converter = new StringNotEmptyConverter();
        var value = "test string";

        // Act
        var result = converter.Convert(value, typeof(bool), null, CultureInfo.InvariantCulture);

        // Assert
        Assert.True((bool)result);
    }

    [Fact]
    public void Convert_ShouldReturnFalse_WhenValueIsNull()
    {
        // Arrange
        var converter = new StringNotEmptyConverter();

        // Act
        var result = converter.Convert(null, typeof(bool), null, CultureInfo.InvariantCulture);

        // Assert
        Assert.False((bool)result);
    }

    [Fact]
    public void Convert_ShouldReturnFalse_WhenValueIsEmptyString()
    {
        // Arrange
        var converter = new StringNotEmptyConverter();
        var value = string.Empty;

        // Act
        var result = converter.Convert(value, typeof(bool), null, CultureInfo.InvariantCulture);

        // Assert
        Assert.False((bool)result);
    }

    [Fact]
    public void Convert_ShouldReturnFalse_WhenValueIsWhitespace()
    {
        // Arrange
        var converter = new StringNotEmptyConverter();
        var value = "   ";

        // Act
        var result = converter.Convert(value, typeof(bool), null, CultureInfo.InvariantCulture);

        // Assert
        Assert.False((bool)result);
    }

    [Fact]
    public void Convert_ShouldReturnFalse_WhenValueIsTabsAndNewlines()
    {
        // Arrange
        var converter = new StringNotEmptyConverter();
        var value = "\t\n\r";

        // Act
        var result = converter.Convert(value, typeof(bool), null, CultureInfo.InvariantCulture);

        // Assert
        Assert.False((bool)result);
    }

    [Fact]
    public void Convert_ShouldReturnFalse_WhenValueIsNotString()
    {
        // Arrange
        var converter = new StringNotEmptyConverter();
        var value = 123;

        // Act
        var result = converter.Convert(value, typeof(bool), null, CultureInfo.InvariantCulture);

        // Assert
        Assert.False((bool)result);
    }

    [Fact]
    public void Convert_ShouldReturnTrue_WhenValueContainsOnlyOneCharacter()
    {
        // Arrange
        var converter = new StringNotEmptyConverter();
        var value = "a";

        // Act
        var result = converter.Convert(value, typeof(bool), null, CultureInfo.InvariantCulture);

        // Assert
        Assert.True((bool)result);
    }

    [Fact]
    public void Convert_ShouldReturnTrue_WhenValueHasLeadingAndTrailingSpacesButContent()
    {
        // Arrange
        var converter = new StringNotEmptyConverter();
        var value = "  content  ";

        // Act
        var result = converter.Convert(value, typeof(bool), null, CultureInfo.InvariantCulture);

        // Assert
        Assert.True((bool)result);
    }

    [Fact]
    public void ConvertBack_ShouldThrowNotImplementedException()
    {
        // Arrange
        var converter = new StringNotEmptyConverter();

        // Act & Assert
        Assert.Throws<NotImplementedException>(() =>
            converter.ConvertBack(true, typeof(string), null, CultureInfo.InvariantCulture));
    }
}